# RabbitMQ installation

- Create a `values_rabbitmq.yaml` file that will contain the user name and password for the console.

```
auth:
  username: admin
  password: reallyStrongPassword
```

- Add the binami Helm repo

```shell
helm repo add bitnami https://charts.bitnami.com/bitnami
```

- Update the repo

```shell
helm repo update
```

- Install the `rabbitmq` chart.

```
helm install rabbitmq -f hub-kube/values_rabbitmq.yaml bitnami/rabbitmq
```

```
NAME: rabbitmq
LAST DEPLOYED: Tue Oct 10 17:02:51 2023
NAMESPACE: default
STATUS: deployed
REVISION: 1
TEST SUITE: None
NOTES:
CHART NAME: rabbitmq
CHART VERSION: 12.2.0
APP VERSION: 3.12.6** Please be patient while the chart is being deployed **

Credentials:
    echo "Username      : admin"
    echo "Password      : $(kubectl get secret --namespace default rabbitmq -o jsonpath="{.data.rabbitmq-password}" | base64 -d)"
    echo "ErLang Cookie : $(kubectl get secret --namespace default rabbitmq -o jsonpath="{.data.rabbitmq-erlang-cookie}" | base64 -d)"

Note that the credentials are saved in persistent volume claims and will not be changed upon upgrade or reinstallation unless the persistent volume claim has been deleted. If this is not the first installation of this chart, the credentials may not be valid.
This is applicable when no passwords are set and therefore the random password is autogenerated. In case of using a fixed password, you should specify it when upgrading.
More information about the credentials may be found at https://docs.bitnami.com/general/how-to/troubleshoot-helm-chart-issues/#credential-errors-while-upgrading-chart-releases.

RabbitMQ can be accessed within the cluster on port 5672 at rabbitmq.default.svc.cluster.local

To access for outside the cluster, perform the following steps:

To Access the RabbitMQ AMQP port:

    echo "URL : amqp://127.0.0.1:5672/"
    kubectl port-forward --namespace default svc/rabbitmq 5672:5672

To Access the RabbitMQ Management interface:

    echo "URL : http://127.0.0.1:15672/"
    kubectl port-forward --namespace default svc/rabbitmq 15672:15672
```

- Create a secret in the namespace 


```
kubectl create secret generic rabbitmq-broker-url --from-literal=BROKER_URL='amqp://user:password@rabbitmq.default.svc.cluster.local:5672/vhost'
```

  username: admin
  password: 63dX?4Vo44s'


  kubectl create secret generic rabbitmq-broker-url --from-literal=BROKER_URL='amqp://admin:63dX?4Vo44s\'@rabbitmq.default.svc.cluster.local:5672/vhost'

  kubectl create secret generic rabbitmq-broker-url --from-literal=BROKER_URL='amqp://admin:63dF4Vo44s@rabbitmq.default.svc.cluster.local:5672'

  kubectl create secret generic rabbitmq-broker-url --from-literal=BROKER_URL='amqp://admin:63dX?4Vo44s@rabbitmq.default.svc.cluster.local:5672'
