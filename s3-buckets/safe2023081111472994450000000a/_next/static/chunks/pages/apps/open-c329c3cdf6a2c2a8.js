(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2967],{24162:function(e,n,t){"use strict";var r=t(91941);n.Z=void 0;var s=r(t(64938)),i=t(85893),a=(0,s.default)((0,i.jsx)("path",{d:"m19 15-1.41-1.41L13 18.17V2h-2v16.17l-4.59-4.59L5 15l7 7 7-7z"}),"South");n.Z=a},60194:function(e,n,t){"use strict";var r=t(91941);n.Z=void 0;var s=r(t(64938)),i=t(85893),a=(0,s.default)((0,i.jsx)("path",{d:"M12 5.99 19.53 19H4.47L12 5.99M12 2 1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"WarningAmberOutlined");n.Z=a},92401:function(e,n,t){"use strict";t.d(n,{Z:function(){return x}});var r=t(32793),s=t(1048),i=t(67294),a=t(90512),o=t(94780),c=t(90948),u=t(71657),l=t(15861),d=t(1588),f=t(34867);function p(e){return(0,f.Z)("MuiAlertTitle",e)}(0,d.Z)("MuiAlertTitle",["root"]);var h=t(85893);const m=["className"],v=(0,c.ZP)(l.Z,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(e,n)=>n.root})((({theme:e})=>({fontWeight:e.typography.fontWeightMedium,marginTop:-2})));var x=i.forwardRef((function(e,n){const t=(0,u.Z)({props:e,name:"MuiAlertTitle"}),{className:i}=t,c=(0,s.Z)(t,m),l=t,d=(e=>{const{classes:n}=e;return(0,o.Z)({root:["root"]},p,n)})(l);return(0,h.jsx)(v,(0,r.Z)({gutterBottom:!0,component:"div",ownerState:l,ref:n,className:(0,a.Z)(d.root,i)},c))}))},17173:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/apps/open",function(){return t(34652)}])},96710:function(e,n,t){"use strict";var r=t(85893),s=t(77430),i=t.n(s);n.Z=function(e){var n=e.appUrl,t=e.allowedFeaturesList,s=e.iframeRef,a=e.onLoad,o=e.title;return(0,r.jsx)("iframe",{className:i().iframe,id:"iframe-".concat(n),ref:s,src:n,title:o,onLoad:a,sandbox:"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-forms allow-downloads allow-orientation-lock",allow:t})}},73785:function(e,n,t){"use strict";t.d(n,{z:function(){return r},Z:function(){return Z}});var r,s=t(47568),i=t(26042),a=t(34051),o=t.n(a),c=t(67294),u=t(56371),l=t(2593),d=t(40936),f=t(65681),p=t(51438),h=t(16337),m=function e(n,t){var r=this;(0,p.Z)(this,e),this.handlers=new Map,this.on=function(e,n){r.handlers.set(e,n)},this.isValidMessage=function(e){var n;if(e.data.hasOwnProperty("isCookieEnabled"))return!0;var t=(null===(n=r.iframeRef.current)||void 0===n?void 0:n.contentWindow)===e.source,s=Object.values(d.Methods).includes(e.data.method);return t&&s},this.canHandleMessage=function(e){return Boolean(r.handlers.get(e.data.method))},this.send=function(e,n){var t,s,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=(0,d.getSDKVersion)(),o=i?d.MessageFormatter.makeErrorResponse(n,e,a):d.MessageFormatter.makeResponse(n,e,a);null===(t=r.iframeRef.current)||void 0===t||null===(s=t.contentWindow)||void 0===s||s.postMessage(o,"*")};var i=this;this.handleIncomingMessage=function(){var e=(0,s.Z)(o().mark((function e(n){var t,r,s,a,c,u,l,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.isValidMessage(n),r=i.canHandleMessage(n),!t||!r){e.next=19;break}return c=i.handlers.get(n.data.method),null===(s=i.config)||void 0===s||null===(a=s.onMessage)||void 0===a||a.call(s,n),e.prev=6,e.next=9,c(n);case 9:"undefined"!==typeof(u=e.sent)&&i.send(u,n.data.id),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(6),f=(0,h.T)(e.t0),i.send(f.message,n.data.id,!0),null===(l=i.config)||void 0===l||null===(d=l.onError)||void 0===d||d.call(l,f,n.data);case 19:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(n){return e.apply(this,arguments)}}(),this.clear=function(){window.removeEventListener("message",r.handleIncomingMessage),r.handlers.clear()},this.iframeRef=n,this.config=t||{},window.addEventListener("message",this.handleIncomingMessage)},v=t(9434),x=t(81511),g=t(62687),j=t(89336),C=t(39059);!function(e){e.REJECT_TRANSACTION_MESSAGE="Transaction was rejected"}(r||(r={}));var Z=function(e,n,t,r){var a=(0,c.useState)(void 0),p=a[0],h=a[1],Z=(0,j.CG)(C.re),w=(0,c.useMemo)((function(){if(t)return(0,x.dG)(t.rpcUri,null===Z||void 0===Z?void 0:Z[t.chainId])}),[t,Z]);return(0,c.useEffect)((function(){var t;return n&&function(e,n){t=new m(e,{onMessage:function(e){var t,r=n&&n.id<1;(0,g.vQ)((0,i.Z)({},g.Lh.SAFE_APP_SDK_METHOD_CALL),r?null===n||void 0===n?void 0:n.url:(null===n||void 0===n?void 0:n.name)||"",{method:e.data.method,ethMethod:null===(t=e.data.params)||void 0===t?void 0:t.call,version:e.data.env.sdkVersion})},onError:function(e,t){(0,v.H)(v.D1._901,e.message,{contexts:{safeApp:n||{},request:t}})}}),h(t)}(e,n),function(){null===t||void 0===t||t.clear()}}),[n,e]),(0,c.useEffect)((function(){null===p||void 0===p||p.on(d.Methods.getTxBySafeTxHash,(function(e){var n=e.data.params.safeTxHash;return r.onGetTxBySafeTxHash(n)})),null===p||void 0===p||p.on(d.Methods.getEnvironmentInfo,r.onGetEnvironmentInfo),null===p||void 0===p||p.on(d.Methods.getSafeInfo,r.onGetSafeInfo),null===p||void 0===p||p.on(d.Methods.getSafeBalances,(function(e){var n=e.data.params.currency,t=void 0===n?"usd":n;return r.onGetSafeBalances(t)})),null===p||void 0===p||p.on(d.Methods.rpcCall,function(){var e=(0,s.Z)(o().mark((function e(n){var t,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=n.data.params).call!==f.RPC_CALLS.safe_setSettings){e.next=4;break}return s=t.params[0],e.abrupt("return",r.onSetSafeSettings(s));case 4:return e.prev=4,e.next=7,null===w||void 0===w?void 0:w.send(t.call,t.params);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),new Error(e.t0.error);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(n){return e.apply(this,arguments)}}()),null===p||void 0===p||p.on(d.Methods.sendTransactions,(function(e){var n=e.data.params,t=n.txs,s=n.params,i=t.map((function(e){var n=e.to,t=e.value,r=e.data;return{to:(0,u.getAddress)(n),value:l.O$.from(t).toString(),data:r}}));r.onConfirmTransactions(i,e.data.id,s)})),null===p||void 0===p||p.on(d.Methods.signMessage,(function(e){var n=e.data.params.message,t=e.data.env.sdkVersion;r.onSignMessage(n,e.data.id,d.Methods.signMessage,t)})),null===p||void 0===p||p.on(d.Methods.getOffChainSignature,(function(e){return r.onGetOffChainSignature(e.data.params)})),null===p||void 0===p||p.on(d.Methods.signTypedMessage,(function(e){var n=e.data.params.typedData,t=e.data.env.sdkVersion;r.onSignMessage(n,e.data.id,d.Methods.signTypedMessage,t)})),null===p||void 0===p||p.on(d.Methods.getChainInfo,r.onGetChainInfo),null===p||void 0===p||p.on(d.Methods.wallet_getPermissions,(function(e){return r.onGetPermissions(e.origin)})),null===p||void 0===p||p.on(d.Methods.wallet_requestPermissions,(function(e){r.onSetPermissions({origin:e.origin,request:e.data.params,requestId:e.data.id})})),null===p||void 0===p||p.on(d.Methods.requestAddressBook,(function(e){return r.onRequestAddressBook(e.origin)}))}),[w,r,t,p]),p}},85881:function(e,n,t){"use strict";var r=t(67294),s=t(73936),i=t(74727),a=t(91589),o=t(84177),c=t(93857);n.Z=function(){var e=(0,o.Z)(),n=e.safe,t=e.safeAddress,u=(0,a.Z)(),l=(0,s.ZP)(),d=(0,i.Ul)(),f=(null===d||void 0===d?void 0:d.chainName)||"";return(0,r.useMemo)((function(){return function(){return{safeAddress:t,chainId:parseInt(l,10),owners:n.owners.map((function(e){return e.value})),threshold:n.threshold,isReadOnly:!u,network:(0,c.fk)(f||"",l).toUpperCase()}}}),[l,f,u,t,n.owners,n.threshold])}},14081:function(e,n,t){"use strict";var r=t(85893),s=t(69368),i=t(50480);n.Z=function(e){var n=e.label,t=e.checked,a=e.onChange,o=e.name;return(0,r.jsx)(i.Z,{sx:function(e){return{flex:1,".MuiIconButton-root:not(.Mui-checked)":{color:e.palette.text.disabled}}},control:(0,r.jsx)(s.Z,{checked:t,onChange:a,name:o}),label:n})}},57678:function(e,n,t){"use strict";t.d(n,{H:function(){return f}});var r=t(47568),s=t(10253),i=t(34051),a=t.n(i),o=t(67294),c=t(18831),u=t(9434),l=t(94232),d=t(65934),f=function(e,n){var t=(0,s.Z)((0,l.Z)((0,r.Z)(a().mark((function t(){var r,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:return r=e.endsWith("/")?(0,d.Os)(e):"".concat(e,"/"),t.next=5,(0,c.getSafeApps)(n,{url:e});case 5:if((s=t.sent)[0]){t.next=10;break}return t.next=9,(0,c.getSafeApps)(n,{url:r});case 9:s=t.sent;case 10:return t.abrupt("return",null===s||void 0===s?void 0:s[0]);case 11:case"end":return t.stop()}}),t)}))),[n,e]),3),i=t[0],f=t[1],p=t[2];return(0,o.useEffect)((function(){f&&(0,u.H)(u.D1._900,f.message)}),[f]),[i,f,p]}},16533:function(e,n,t){"use strict";t.d(n,{Y:function(){return l}});var r=t(10253),s=t(67294),i=t(9434),a=t(73816),o=t(94232),c=t(93857),u=t(16337),l=function(e,n){var t=(0,r.Z)((0,o.Z)((function(){if(e&&n)return(0,a.Cw)(e,n)}),[e,n]),3),l=t[0],d=t[1],f=t[2],p=(0,s.useMemo)((function(){return(0,c.V2)(e)}),[e]);return(0,s.useEffect)((function(){d&&(0,i.H)(i.D1._903,"".concat(e,", ").concat((0,u.T)(d).message))}),[e,d]),{safeApp:l||p,isLoading:f}}},66436:function(e,n,t){"use strict";t.d(n,{P:function(){return a}});var r=t(11163),s=t(65934),i=t(67294),a=function(){var e=(0,r.useRouter)(),n=(0,i.useState)(),t=n[0],a=n[1];return(0,i.useEffect)((function(){var n;e.isReady&&a(null===(n=e.query.appUrl)||void 0===n?void 0:n.toString())}),[e]),(0,i.useMemo)((function(){return t?(0,s.Nm)(t):void 0}),[t])}},34652:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Jn}});var r,s=t(85893),i=t(11163),a=t(67294),o=t(99226),c=t(98456),u=t(66436),l=t(28371),d=t(18377),f=t(41796),p=t(86886),h=t(81458),m=t(83321),v=t(31579),x=t.n(v),g=function(e){var n=e.onSlideChange,t=e.children,r=e.initialStep,i=(0,a.useMemo)((function(){return a.Children.toArray(t).filter(Boolean)}),[t]),c=(0,a.useState)(r||0),u=c[0],l=c[1],d=(0,a.useState)(!1),f=d[0],p=d[1];(0,a.useEffect)((function(){var e;return f&&(e=setTimeout((function(){p(!1)}),500)),function(){e&&clearTimeout(e)}}),[f]);var h=0===u;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:x().sliderContainer,children:(0,s.jsx)("div",{className:x().sliderInner,style:{transform:"translateX(-".concat(100*u,"%)")},children:i.map((function(e,n){return(0,s.jsx)("div",{className:x().sliderItem,children:e},n)}))})}),(0,s.jsxs)(o.Z,{display:"flex",justifyContent:"center",width:"100%",children:[(0,s.jsx)(m.Z,{color:"primary",variant:"outlined",size:"small",fullWidth:!0,onClick:function(){if(!f){var e=u-1;n(e),l(e),p(!0)}},children:h?"Cancel":"Back"}),(0,s.jsx)(m.Z,{color:"primary",variant:"contained",size:"small",fullWidth:!0,onClick:function(){if(!f){var e=u+1;n(e),l(e),p(!0)}},style:{marginLeft:10},children:"Continue"})]})]})},j=t(34636),C=t(90551),Z=t(15861),w=function(){return(0,s.jsxs)("div",{className:x().disclaimerContainer,children:[(0,s.jsx)(Z.Z,{variant:"body2",color:"text.secondary",mx:8,children:"Before starting to use Safe dApps..."}),(0,s.jsx)(Z.Z,{variant:"h3",fontWeight:700,my:3,children:"Disclaimer"}),(0,s.jsxs)("div",{className:x().disclaimerInner,children:[(0,s.jsx)(Z.Z,{mb:4,children:"You are now accessing third-party apps, which we do not own, control, maintain or audit. We are not liable for any loss you may suffer in connection with interacting with the apps, which is at your own risk."}),(0,s.jsx)(Z.Z,{mb:4,children:"You must read our Terms, which contain more detailed provisions binding on you relating to the apps."}),(0,s.jsxs)(Z.Z,{children:["I have read and understood the"," ",(0,s.jsx)(j.Z,{href:C.$.terms,sx:{textDecoration:"none"},children:"Terms"})," ","and this Disclaimer, and agree to be bound by them."]})]})]})},y=t(53219),b=["title","titleId"];function S(){return S=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},S.apply(this,arguments)}function A(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var E,k=function(e){var n=e.title,t=e.titleId,s=A(e,b);return a.createElement("svg",S({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t},s),n?a.createElement("title",{id:t},n):null,r||(r=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.6748 21.9362C11.9021 22.0215 12.1527 22.0213 12.3798 21.9355C16.3253 20.4449 18.8299 18.3949 20.089 16.0572C20.3255 15.6341 20.5105 15.1643 20.6517 14.6561C20.8149 14.069 20.9142 13.4521 20.9639 12.8264C20.9975 12.4042 21.0048 12.0411 20.9981 11.717C20.9965 11.647 20.9965 11.647 20.9964 11.654V5.279C20.9964 4.69989 20.506 4.24186 19.9282 4.28133C19.4283 4.31547 19.1772 4.328 18.8994 4.328C16.2811 4.328 14.1185 3.39264 12.6182 2.21372C12.2322 1.91033 11.6829 1.93214 11.3221 2.2652C11.3006 2.28505 11.2747 2.30621 11.2358 2.33553C11.2057 2.35816 11.1689 2.38486 11.0714 2.45561C10.6544 2.73402 10.4122 2.88668 10.0484 3.08197C9.96778 3.12523 9.88702 3.16697 9.80602 3.20715C8.38423 3.90539 6.84274 4.328 5.10338 4.328C4.82402 4.328 4.57478 4.31557 4.07352 4.28133C3.49576 4.24186 3.00538 4.69989 3.00538 5.279V11.606C2.92126 12.7826 3.22547 14.8548 4.05794 16.2732C4.2169 16.5679 4.42431 16.8738 4.68419 17.2033C6.16047 19.1604 8.51801 20.7508 11.6748 21.9362ZM18.3403 15.0866L18.3315 15.1027C17.3487 16.9318 15.3335 18.6175 12.0254 19.9282C9.38042 18.8858 7.4534 17.5534 6.26767 15.9817C6.06087 15.7192 5.91605 15.5056 5.79967 15.2907C5.45153 14.6964 5.22422 13.9393 5.09977 13.0916C5.01415 12.5084 4.98663 11.9106 5.00297 11.6753L5.00498 6.32759C5.03744 6.32787 5.07014 6.328 5.10338 6.328C7.17923 6.328 9.01073 5.82588 10.6912 5.0006C10.7953 4.94898 10.8951 4.8974 10.9943 4.84414C11.364 4.6457 11.625 4.48652 12 4.23889C13.7668 5.4456 16.1089 6.328 18.8994 6.328C18.9321 6.328 18.9644 6.32787 18.9964 6.32759V11.654C18.9973 11.7081 18.9973 11.7081 18.9985 11.7587C19.004 12.0208 18.998 12.3192 18.9702 12.6679C18.93 13.1745 18.8505 13.6681 18.7247 14.1207C18.6232 14.4861 18.4949 14.8112 18.3403 15.0866Z"})))},T=t(46115),_=t(14081),M=t(86551),I=function(e){var n=e.features,t=e.onFeatureSelectionChange;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{component:k,inheritViewBox:!0,color:"primary"}),(0,s.jsx)(Z.Z,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",margin:"0 75px"},children:"Manage the features Safe Apps can use"}),(0,s.jsxs)(o.Z,{mx:1,my:3,textAlign:"left",children:[(0,s.jsx)(Z.Z,{children:"This Safe App is requesting permission to use:"}),(0,s.jsx)(o.Z,{display:"flex",flexDirection:"column",ml:2,mt:1,children:n.filter((function(e){var n=e.feature;return(0,M.V)(n)})).map((function(e,n){var r=e.feature,i=e.checked;return(0,s.jsx)(_.Z,{name:"checkbox",checked:i,onChange:function(e,n){return t(r,n)},label:(0,T.uB)(r).displayName},n)}))})]})]})},P=t(69368),R=t(50480),O=t(60194),N=t(41706),L=t(27036),D=function(e){var n=e.url,t=e.showInOneLine;return(0,s.jsxs)(Z.Z,{className:x().domainText,sx:t?{overflowY:"hidden",whiteSpace:"nowrap"}:{},children:[(0,s.jsx)(L.Z,{color:"success",className:x().domainIcon})," ",n]})},B=function(e){var n=e.url,t=e.onHideWarning,r=(0,a.useState)(!1),i=r[0],c=r[1];return(0,s.jsxs)(o.Z,{display:"flex",flexDirection:"column",height:"100%",alignItems:"center",children:[(0,s.jsxs)(o.Z,{display:"block",alignItems:"center",mt:6,children:[(0,s.jsx)(O.Z,{fontSize:"large",color:"warning"}),(0,s.jsx)(Z.Z,{variant:"h3",fontWeight:700,mt:2,color:N.lightPalette.warning.main,children:"Warning"})]}),(0,s.jsx)(Z.Z,{my:2,fontWeight:700,color:N.lightPalette.warning.main,children:"The application you are trying to access is not in the default Safe Apps list"}),(0,s.jsx)(Z.Z,{my:2,textAlign:"center",children:"Check the link you are using and ensure that it comes from a source you trust"}),n&&(0,s.jsx)(D,{url:n,showInOneLine:!0}),t&&(0,s.jsx)(o.Z,{mt:2,children:(0,s.jsx)(R.Z,{control:(0,s.jsx)(P.Z,{checked:i,onChange:function(){null===t||void 0===t||t(!i),c(!i)},name:"Warning message preference"}),label:"Don't show this warning again"})})]})},q=t(93857),U=function(e){var n=e.onCancel,t=e.onConfirm,r=e.features,i=e.appUrl,o=e.isConsentAccepted,c=e.isPermissionsReviewCompleted,u=e.isSafeAppInDefaultList,l=e.isFirstTimeAccessingApp,m=(0,a.useState)(!1),v=m[0],x=m[1],j=(0,a.useState)(r.map((function(e){return{feature:e,checked:!0}}))),C=j[0],Z=j[1],y=(0,a.useState)(0),b=y[0],S=y[1],A=(0,a.useMemo)((function(){var e=0;return o||(e+=1),c||(e+=1),!u&&l&&(e+=1),e}),[o,l,c,u]),E=(0,a.useMemo)((function(){return 100*(b+1)/A}),[b,A]),k=(0,a.useMemo)((function(){return!u&&l}),[l,u]),T=(0,a.useMemo)((function(){return(0,q.P$)(i)}),[i]);return(0,s.jsx)(d.Z,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"calc(100vh - 52px)",children:(0,s.jsxs)(d.Z,{sx:function(e){var n=e.palette;return{width:"450px",backgroundColor:n.background.paper,boxShadow:"1px 2px 10px 0 ".concat((0,f.Fq)(n.text.primary,.18))}},children:[(0,s.jsx)(h.Z,{variant:"determinate",value:E,sx:function(e){var n=e.palette;return{height:"6px",backgroundColor:n.background.paper,borderRadius:"8px 8px 0 0","> .MuiLinearProgress-bar":{backgroundColor:100===E&&k?n.warning.main:n.primary.main,borderRadius:"8px"}}}}),(0,s.jsx)(p.ZP,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",textAlign:"center",p:3,children:(0,s.jsxs)(g,{onSlideChange:function(e){var r=e===A;-1===e&&n(),r&&t(v,C.map((function(e){return{feature:e.feature,status:e.checked?M.n.GRANTED:M.n.DENIED}}))),S(e)},children:[!o&&(0,s.jsx)(w,{}),!c&&(0,s.jsx)(I,{features:C,onFeatureSelectionChange:function(e,n){Z(C.map((function(t){return t.feature===e?{feature:e,checked:n}:t})))}}),k&&(0,s.jsx)(B,{url:T,onHideWarning:x})]})})]})})},W=(0,a.memo)(U),G=t(14924),V=t(26042),F=t(69396),z=t(10253),H=t(29815),Q=t(73936),Y=t(99805),J=function(e){var n,t=e.url,r=e.safeApp,s=e.permissions,i=e.addPermissions,o=e.getPermissions,c=e.remoteSafeAppsLoading,u=(0,a.useRef)(!1),l=(0,Q.ZP)(),d=(0,z.Z)((0,Y.Z)("SafeApps__infoModal"),2),f=d[0],p=void 0===f?{}:f,h=d[1],m=(0,a.useState)(!1),v=m[0],x=m[1];(0,a.useEffect)((function(){t||x(!1)}),[t]),(0,a.useEffect)((function(){u.current||(u.current=!0)}),[]);var g=(0,a.useMemo)((function(){if(!t)return!1;return!!(s||[]).every((function(e){return o(t).some((function(n){return n.feature===e&&n.status!==M.n.PROMPT}))}))}),[o,t,s]),j=(0,a.useMemo)((function(){return!!t&&!!r}),[r,t]),C=(0,a.useMemo)((function(){var e,n;return!t||(!p[l]||!(null===(e=p[l])||void 0===e||null===(n=e.warningCheckedCustomApps)||void 0===n?void 0:n.includes(t)))}),[l,p,t]),Z=(0,a.useMemo)((function(){var e=u.current,n=!p[l]||!1===p[l].consentsAccepted;return e&&(n||!c&&!j&&C&&!v||!g)}),[l,g,C,j,v,c,p]),w=(0,a.useCallback)((function(e,n){var r,s,a,o={consentsAccepted:!0,warningCheckedCustomApps:(0,H.Z)((null===(r=p[l])||void 0===r?void 0:r.warningCheckedCustomApps)||[])},c=(0,q.P$)(t);e&&!(null===(s=p[l])||void 0===s||null===(a=s.warningCheckedCustomApps)||void 0===a?void 0:a.includes(c))&&o.warningCheckedCustomApps.push(c),h((0,F.Z)((0,V.Z)({},p),(0,G.Z)({},l,o))),g||i(t,n),x(!0)}),[i,l,g,p,h,t]);return{isModalVisible:Z,isSafeAppInDefaultList:j,isFirstTimeAccessingApp:C,isPermissionsReviewCompleted:g,isConsentAccepted:!!(null===p||void 0===p||null===(n=p[l])||void 0===n?void 0:n.consentsAccepted),onComplete:w}},$=t(51438),K=t(28668),X=t(71418),ee=function(e){(0,K.Z)(t,e);var n=(0,X.Z)(t);function t(e){var r;return(0,$.Z)(this,t),(r=n.call(this,e)).state={hasError:!1},r.state={hasError:!1},r}var r=t.prototype;return r.componentDidCatch=function(e,n){console.error("Uncaught error:",e,n)},r.render=function(){return this.state.hasError?this.props.render():this.props.children},t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t}(a.Component),ne=t(8002),te=["title","titleId"];function re(){return re=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},re.apply(this,arguments)}function se(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var ie=function(e){var n=e.title,t=e.titleId,r=se(e,te);return a.createElement("svg",re({xmlns:"http://www.w3.org/2000/svg",width:90,height:90,viewBox:"0 0 90 90","aria-labelledby":t},r),n?a.createElement("title",{id:t},n):null,E||(E=a.createElement("g",{fill:"none",fillRule:"evenodd"},a.createElement("circle",{cx:45,cy:45,r:45,className:"illustration-background-fill"}),a.createElement("path",{className:"illustration-light-fill",fillRule:"nonzero",d:"M26.24 62c-.57 0-1.13-.15-1.623-.437a3.254 3.254 0 0 1-1.18-4.44l18.76-32.501a3.234 3.234 0 0 1 5.606 0l18.761 32.501c.286.495.436 1.057.436 1.628A3.244 3.244 0 0 1 63.76 62H26.24z"}),a.createElement("path",{className:"illustration-background-fill",fillRule:"nonzero",d:"M47 49h-4V36h4zM47 55h-4v-4h4z"}),a.createElement("circle",{cx:78,cy:78,r:11,className:"illustration-main-fill",fillRule:"nonzero",strokeWidth:4}))))},ae=t(97445),oe=t.n(ae),ce=function(e){var n=e.onBackToApps;return(0,s.jsx)("div",{className:oe().wrapper,children:(0,s.jsxs)("div",{className:oe().content,children:[(0,s.jsx)(Z.Z,{variant:"h1",children:"Safe App could not be loaded"}),(0,s.jsx)(y.Z,{component:ie,inheritViewBox:!0,className:oe().image}),(0,s.jsxs)("div",{children:[(0,s.jsx)(Z.Z,{component:"span",children:"In case the problem persists, please reach out to us via "}),(0,s.jsx)(j.Z,{href:ne.Vs,fontSize:"medium",children:"Discord"})]}),(0,s.jsx)(m.Z,{href:"#back",color:"primary",onClick:n,children:"Go back to the Safe Apps list"})]})})},ue=t(47568),le=t(34051),de=t.n(le),fe=t(9008),pe=t.n(fe),he=t(18831),me=t(40936),ve=t(49257),xe=t(31960),ge=t(62687),je=t(16533),Ce=t(84177),Ze=t(57678),we=t(16849),ye=t(74727),be=t(65934),Se=t(96805),Ae=t(79509),Ee=function(){var e=(0,a.useState)(!1),n=e[0],t=e[1],r=(0,a.useState)(!1),s=r[0],i=r[1],o=(0,Se.Z)().page,c=void 0===o?{results:[]}:o,u=(0,a.useContext)(Ae.i).txFlow,l=(0,a.useCallback)((function(){i(!0)}),[]);return(0,a.useEffect)((function(){u&&t(!1)}),[u]),{expanded:n,dismissedByUser:s,setExpanded:t,dismissQueueBar:l,transactions:c}},ke=t(77350),Te=t(9434),_e=function(){var e=(0,a.useRef)(),n=(0,a.useState)(!1),t=n[0],r=n[1],s=(0,a.useCallback)((function(n){var t=n.data;try{t.hasOwnProperty("isCookieEnabled")&&(r(!t.isCookieEnabled),window.removeEventListener("message",s),document.body.removeChild(e.current))}catch(i){(0,Te.H)(Te.D1._905,i)}}),[]);return(0,a.useEffect)((function(){if(!(navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")<=-1)){window.addEventListener("message",s);var n=function(e,n){var t=document.createElement("iframe");return t.src=e,t.setAttribute("style","display:none"),t.onload=n,t}(ne.A8,(function(){var e;return null===n||void 0===n||null===(e=n.contentWindow)||void 0===e?void 0:e.postMessage({test:"cookie"},"*")}));e.current=n,document.body.appendChild(n)}}),[s]),(0,a.useEffect)((function(){var e;return t&&(e=setTimeout((function(){return r(!1)}),1e4)),function(){return clearTimeout(e)}}),[t]),{thirdPartyCookiesDisabled:t,setThirdPartyCookiesDisabled:r}},Me=t(94434),Ie=[/^http:\/\/localhost:[0-9]{4}$/,/^https:\/\/safe-apps\.dev\.5afe\.dev$/,/^https:\/\/apps\.gnosis-safe\.io$/,/^https:\/\/apps-portal\.safe\.global$/],Pe=function(e){var n=(0,a.useCallback)((function(n){var t,r=(null===(t=e.current)||void 0===t?void 0:t.contentWindow)===n.source,s=n.data.category===Me.NS,i=void 0!==Ie.find((function(e){return e.test(n.origin)}));return r&&s&&i}),[e]),t=(0,a.useCallback)((function(e){if(n(e)){var t=e.data,r=t.action,s=t.label,i=t.safeAppName;(0,ge.vQ)({event:ge.tw.SAFE_APP,category:Me.NS,action:r,label:s},i)}}),[n]);(0,a.useEffect)((function(){return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}}),[t])},Re=function(){var e=(0,a.useState)(!0),n=e[0],t=e[1],r=(0,a.useState)(!1),s=r[0],i=r[1],o=(0,a.useState)(!1)[1],c=(0,a.useRef)(null),u=(0,a.useRef)(),l=(0,a.useRef)();return(0,a.useEffect)((function(){var e=function(){clearTimeout(u.current),clearTimeout(l.current)};return n?(u.current=window.setTimeout((function(){i(!0)}),15e3),l.current=window.setTimeout((function(){o((function(){throw Error("There was an error loading the Safe App. There might be a problem with the Safe App provider.")}))}),3e4)):(e(),i(!1)),function(){e()}}),[n]),{iframeRef:c,appIsLoading:n,setAppIsLoading:t,isLoadingSlow:s}},Oe=t(73785),Ne=t(46901),Le=t(92401),De=function(e){var n=e.onClose;return(0,s.jsx)(Ne.Z,{severity:"warning",onClose:n,sx:function(e){var n=e.palette;return{background:n.warning.light,border:0,borderBottom:"1px solid ".concat(n.warning.main),borderRadius:"0px !important"}},children:(0,s.jsxs)(Le.Z,{children:["Third party cookies are disabled. Safe Apps may therefore not work properly. You can find out more information about this"," ",(0,s.jsx)(j.Z,{href:ne.Jb.COOKIES,fontSize:"inherit",children:"here"})]})})},Be=t(84808),qe=t(93946),Ue=t(67358),We=t(22797),Ge=t(38895),Ve=t(23926),Fe=t(50594),ze=t(60181),He=t(50644),Qe=t(58831),Ye=t.n(Qe),Je=t(84295),$e=t(5329),Ke=t(30641),Xe="64px",en=function(e){var n=e.expanded,t=e.visible,r=e.setExpanded,i=e.onDismiss,a=e.transactions;if(!t||0===a.results.length)return null;var c=(0,Je.QY)(a),u="(".concat(c,") Transaction queue");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{className:Ye().barWrapper,children:(0,s.jsx)(Ve.Z,{onClickAway:function(){return r(!1)},mouseEvent:"onMouseDown",touchEvent:"onTouchStart",children:(0,s.jsxs)(Ue.Z,{expanded:n,onChange:function(){return r((function(e){return!e}))},TransitionProps:{timeout:{appear:400,enter:0,exit:500},unmountOnExit:!1,mountOnEnter:!0},sx:{borderBottomLeftRadius:"0 !important",borderBottomRightRadius:"0 !important"},children:[(0,s.jsxs)(Ge.Z,{sx:{".MuiAccordionSummary-content":{alignItems:"center"},height:Xe},children:[(0,s.jsx)(Z.Z,{variant:"body1",color:"primary.main",fontWeight:700,sx:{mr:"auto"},children:u}),(0,s.jsx)(qe.Z,{onClick:function(e){e.stopPropagation(),r((function(e){return!e}))},"aria-label":"".concat(n?"close":"expand"," transaction queue bar"),sx:{transform:n?"rotate(180deg)":void 0},children:(0,s.jsx)(ze.Z,{})}),(0,s.jsx)(qe.Z,{onClick:i,"aria-label":"dismiss transaction queue bar",children:(0,s.jsx)(Fe.Z,{})})]}),(0,s.jsx)(We.Z,{children:(0,s.jsxs)($e.N,{children:[(0,s.jsx)(o.Z,{display:"flex",flexDirection:"column",alignItems:"flex-end",children:(0,s.jsx)(Ke.Z,{})}),(0,s.jsx)(He.Z,{useTxns:Se.Z})]})})]})})}),(0,s.jsx)(Be.Z,{open:n})]})},nn=t(69349),tn=t(89336),rn=t(58572),sn=t(53261),an=t(50169),on=t(64666),cn=t(31425),un=t(6514),ln=t(67720),dn=t(5869),fn=function(e){var n=e.origin,t=e.isOpen,r=e.requestId,i=e.permissions,a=e.onReject,o=e.onAccept;return(0,s.jsxs)(on.Z,{open:t,children:[(0,s.jsx)(dn.V,{onClose:function(){return a()},children:(0,s.jsx)(Z.Z,{variant:"body1",fontWeight:700,children:"Permissions Request"})}),(0,s.jsx)(ln.Z,{}),(0,s.jsxs)(un.Z,{children:[(0,s.jsxs)(Z.Z,{children:[(0,s.jsx)("b",{children:n})," is requesting permissions for:"]}),(0,s.jsx)("ul",{children:i.map((function(e,n){return(0,s.jsx)("li",{children:(0,s.jsx)(Z.Z,{children:(0,T.cS)(Object.keys(e)[0]).description})},n)}))})]}),(0,s.jsxs)(cn.Z,{sx:{justifyContent:"center",my:3},children:[(0,s.jsx)(m.Z,{variant:"contained",color:"error",size:"small",onClick:function(){return a(r)},sx:{minWidth:"130px"},children:"Reject"}),(0,s.jsx)(m.Z,{variant:"contained",size:"small",onClick:function(){return o(n,r)},sx:{minWidth:"130px"},children:"Accept"})]})]})},pn=t(77430),hn=t.n(pn),mn=t(96710),vn=t(85881),xn=t(52856),gn=t(39059),jn=t(22594),Cn=t(24975),Zn=t(55310),wn=t(1458),yn=t(96030),bn=t(1083),Sn=t(72991),An=t(52246),En=t(75683),kn=t(91692),Tn=t(16337),_n=function(e){var n=e.safeAppsTx,t=n.txs,r=n.requestId,i=n.params,o=n.appId,c=n.app,u=(0,Ce.Z)().safe,l=(0,bn.ZP)(),d=(0,ye.Ul)(),f=(0,a.useState)(t),p=f[0],h=f[1],m=(0,a.useContext)(An.J),v=m.safeTx,x=m.setSafeTx,g=m.safeTxError,j=m.setSafeTxError;(0,Sn.Z)(),(0,a.useEffect)((function(){var e=function(){var e=(0,ue.Z)(de().mark((function e(){var n;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(p.length>1)){e.next=7;break}return e.next=4,(0,yn.Fh)(p);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,(0,yn.VQ)(p[0]);case 9:e.t0=e.sent;case 10:return n=e.t0,(null===i||void 0===i?void 0:i.safeTxGas)&&(n.data.safeTxGas=i.safeTxGas),e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e().then(x).catch(j)}),[p,x,j,i]);var C=function(){var e=(0,ue.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v&&l){e.next=2;break}return e.abrupt("return");case 2:return(0,ve.dq)(Number(o)),e.prev=3,e.next=6,(0,yn.JS)(v,r,l,u.chainId);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),j((0,Tn.T)(e.t0));case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(){return e.apply(this,arguments)}}(),Z=(0,a.useMemo)((function(){return(0,Je.k)(c)}),[c]),w=!(0,q.cV)(t);return(0,s.jsxs)(wn.Z,{onSubmit:C,origin:Z,children:[(0,s.jsx)(Cn.SV,{fallback:(0,s.jsx)("div",{children:"Error parsing data"}),children:(0,s.jsx)(En.Z,{safeTransaction:v,updateTransaction:h})}),v?(0,s.jsx)(Zn.Z,{address:v.data.to,title:(0,q.Gu)(v.data.value||"",d)}):w?(0,s.jsx)(kn.Z,{error:g,children:"This Safe App initiated a transaction which cannot be processed. Please get in touch with the developer of this Safe App for more information."}):null]})},Mn=t(27884),In=function(e){var n,t,r=e.data;return(0,s.jsx)(jn.Z,{title:"Confirm transaction",subtitle:(0,s.jsx)(Mn.d,{name:null===(n=r.app)||void 0===n?void 0:n.name,logoUri:null===(t=r.app)||void 0===t?void 0:t.iconUrl}),step:0,children:(0,s.jsx)(_n,{safeAppsTx:r})})},Pn=t(56371),Rn=t(29740),On=t(56564),Nn=t(24162),Ln=t(89697),Dn=t.n(Ln),Bn=t(91922),qn=t(65136),Un=function(e){var n=e.title,t=(0,Bn.Z)();return(0,s.jsxs)(o.Z,{className:Dn().container,pb:2,mb:2,children:[(0,s.jsx)(Z.Z,{color:"text.secondary",pb:1,children:n||"Sending from"}),(0,s.jsx)(Z.Z,{variant:"body2",component:"div",children:(0,s.jsx)(qn.Z,{address:t,shortAddress:!1,hasExplorer:!0,showCopyButton:!0})}),(0,s.jsx)(Nn.Z,{className:Dn().arrow})]})},Wn=t(73498),Gn=t(50007),Vn=t(12591),Fn=t(48187),zn=t(67263),Hn=function(e){var n=e.message,t=e.method,r=e.requestId,i=(0,Q.ZP)(),o=(0,Ce.Z)().safe,c=(0,bn.ZP)(),u=(0,a.useContext)(An.J),l=u.safeTx,f=u.setSafeTx,p=u.setSafeTxError;(0,Sn.Z)();var h=t===me.Methods.signMessage&&"string"===typeof n,m=t===me.Methods.signTypedMessage&&(0,me.isObjectEIP712TypedData)(n),v=(0,a.useMemo)((function(){return(0,Vn.vC)(i)}),[i]),x=v.getAddress(),g=(0,a.useMemo)((function(){if(h){var e=(0,q.W7)(n);return[e,e]}return m?[n,JSON.stringify(n,null,2)]:[]}),[h,m,n]),j=g[0],C=g[1];(0,a.useEffect)((function(){var e;if(h)e=v.encode("signMessage",[(0,Pn.hashMessage)((0,q.W7)(n))]);else if(m){var t=(0,V.Z)({},n.types);delete t.EIP712Domain,e=v.encode("signMessage",[Pn._TypedDataEncoder.hash(n.domain,t,n.message)])}var r={to:x,value:"0",data:e||"0x",operation:On.OperationType.DelegateCall};(0,yn.VQ)(r).then(f).catch(p)}),[h,m,n,v,f,p,x]);var w=function(){var e=(0,ue.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l&&c){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,yn.JS)(l,r,c,o.chainId);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),p((0,Tn.T)(e.t0));case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(){return e.apply(this,arguments)}}();return(0,s.jsxs)(wn.Z,{onSubmit:w,children:[(0,s.jsx)(Un,{}),(0,s.jsx)(Wn.C,{title:"Interact with SignMessageLib",children:(0,s.jsx)(qn.Z,{address:x,shortAddress:!1,showCopyButton:!0,hasExplorer:!0})}),l&&(0,s.jsxs)(d.Z,{pb:1,children:[(0,s.jsx)(Z.Z,{mt:2,color:"primary.light",children:"Data (hex encoded)"}),(0,Gn.Y)(l.data.data,"rawData")]}),(0,s.jsxs)(Z.Z,{my:1,children:[(0,s.jsx)("b",{children:"Signing method:"})," ",(0,s.jsx)("code",{children:t})]}),(0,s.jsxs)(Z.Z,{my:2,children:[(0,s.jsx)("b",{children:"Signing message:"})," ",C&&(0,s.jsx)(zn.Z,{text:C})]}),(0,s.jsx)(Fn.H,{message:j,isInModal:!0}),(0,s.jsxs)(d.Z,{display:"flex",alignItems:"center",my:2,children:[(0,s.jsx)(y.Z,{component:Rn.Z,inheritViewBox:!0,color:"warning"}),(0,s.jsx)(Z.Z,{ml:1,children:"Signing a message with your Safe Account requires a transaction on the blockchain"})]})]})},Qn=function(e){var n,t,r=e.props;return(0,s.jsx)(jn.Z,{title:"Confirm message",subtitle:(0,s.jsx)(Mn.d,{name:null===(n=r.app)||void 0===n?void 0:n.name,logoUri:null===(t=r.app)||void 0===t?void 0:t.iconUrl}),step:0,children:(0,s.jsx)(Hn,(0,V.Z)({},r))})},Yn=function(e){var n=e.appUrl,t=e.allowedFeaturesList,r=(0,Q.ZP)(),o=(0,a.useState)({offChainSigning:!0}),u=o[0],l=o[1],d=(0,a.useState)(),f=d[0],p=d[1],h=(0,tn.CG)(rn.Kp),m=(0,Ce.Z)(),v=m.safe,x=m.safeLoaded,g=m.safeAddress,j=(0,tn.CG)(gn.a4),C=(0,tn.CG)(gn.AY),w=(0,we.Z)(),y=(0,ye.Ul)(),b=(0,i.useRouter)(),S=Ee(),A=S.expanded,E=S.dismissedByUser,k=S.setExpanded,_=S.dismissQueueBar,I=S.transactions,P=I.results.length>0&&!E,R=(0,z.Z)((0,Ze.H)(n,v.chainId),3),O=R[0],N=R[2],L=(0,je.Y)(n,v.chainId).safeApp,D=_e(),B=D.thirdPartyCookiesDisabled,q=D.setThirdPartyCookiesDisabled,U=Re(),W=U.iframeRef,G=U.appIsLoading,H=U.isLoadingSlow,Y=U.setAppIsLoading;Pe(W);var J=(0,T.d)(),$=J.getPermissions,K=J.hasPermission,X=J.permissionsRequest,ee=J.setPermissionsRequest,ne=J.confirmPermissionRequest,te=(0,a.useMemo)((function(){return O?O.name:n}),[n,O]),re=(0,a.useContext)(Ae.i).setTxFlow,se=function(){p((function(e){e&&(null===ie||void 0===ie||ie.send(Oe.z.REJECT_TRANSACTION_MESSAGE,e,!0),(0,ge.vQ)(ge.Lh.PROPOSE_TRANSACTION_REJECTED,te))}))},ie=(0,Oe.Z)(W,O||L,y,{onConfirmTransactions:function(e,n,t){var r={app:L,appId:O?String(O.id):void 0,requestId:n,txs:e,params:t};p(n),re((0,s.jsx)(In,{data:r}),se)},onSignMessage:function(e,n,t,r){var i=(0,an.mx)(v,y,r)&&!C;p(n),i?re((0,s.jsx)(Mn.Z,{logoUri:(null===L||void 0===L?void 0:L.iconUrl)||"",name:(null===L||void 0===L?void 0:L.name)||"",message:e,safeAppId:null===O||void 0===O?void 0:O.id,requestId:n}),se):re((0,s.jsx)(Qn,{props:{app:L,appId:null===O||void 0===O?void 0:O.id,requestId:n,message:e,method:t}}))},onGetPermissions:$,onSetPermissions:ee,onRequestAddressBook:function(e){return K(e,me.Methods.requestAddressBook)?Object.entries(w).map((function(e){var n=(0,z.Z)(e,2);return{address:n[0],name:n[1],chainId:r}})):[]},onGetTxBySafeTxHash:function(e){return(0,he.getTransactionDetails)(r,e)},onGetEnvironmentInfo:function(){return{origin:document.location.origin}},onGetSafeInfo:(0,vn.Z)(),onGetSafeBalances:function(e){var n=y&&(0,xn.U6)(y,xn.h6.DEFAULT_TOKENLIST);return(0,he.getBalances)(r,g,e,{exclude_spam:!0,trusted:n&&gn.SA.TRUSTED===j})},onGetChainInfo:function(){if(y){var e=y.nativeCurrency;return{chainName:y.chainName,chainId:y.chainId,shortName:y.shortName,nativeCurrency:e,blockExplorerUriTemplate:y.blockExplorerUriTemplate}}},onSetSafeSettings:function(e){var n=(0,F.Z)((0,V.Z)({},u),{offChainSigning:!!e.offChainSigning});return l(n),n},onGetOffChainSignature:function(){var e=(0,ue.Z)(de().mark((function e(n){var t,s,i,a,o;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=null===(i=null===(t=h.data)||void 0===t||null===(s=t.results)||void 0===s?void 0:s.filter(sn.z))||void 0===i?void 0:i.find((function(e){return e.messageHash===n})))){e.next=4;break}return e.abrupt("return",a.preparedSignature);case 4:return e.prev=4,e.next=7,(0,he.getSafeMessage)(r,n);case 7:return o=e.sent.preparedSignature,e.abrupt("return",o);case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return","");case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(n){return e.apply(this,arguments)}}()});(0,a.useEffect)((function(){O&&(0,ve.xr)(O.id)}),[O]);var ae=(0,a.useCallback)((function(){var e=W.current;e&&(0,be.w0)(e.src,n)&&(Y(!1),(0,ke.kB)("".concat(b.pathname,"?appUrl=").concat(b.query.appUrl)))}),[n,W,Y,b]);return(0,a.useEffect)((function(){G||N||(0,ge.vQ)((0,V.Z)({},ge.Lh.OPEN_APP),te)}),[G,N,te]),(0,a.useEffect)((function(){var e=(0,xe.w)(xe.iZ.SAFE_APPS_REQUEST,function(){var e=(0,ue.Z)(de().mark((function e(n){var t,r;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.safeAppRequestId,r=n.safeTxHash,t&&f===t&&((0,ge.vQ)(ge.Lh.PROPOSE_TRANSACTION,te),null===ie||void 0===ie||ie.send({safeTxHash:r},t));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());return e}),[te,r,ie,f]),(0,a.useEffect)((function(){var e=(0,nn.QO)(nn.np.SIGNATURE_PREPARED,(function(e){var n=e.messageHash,t=e.requestId,r=e.signature;t&&f===t&&(null===ie||void 0===ie||ie.send({messageHash:n,signature:r},t))}));return e}),[ie,f]),x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(pe(),{children:(0,s.jsx)("title",{children:"Safe Apps - Viewer - ".concat(O?O.name:"Unknown Safe App")})}),(0,s.jsxs)("div",{className:hn().wrapper,children:[B&&(0,s.jsx)(De,{onClose:function(){return q(!1)}}),G&&(0,s.jsxs)("div",{className:hn().loadingContainer,children:[H&&(0,s.jsx)(Z.Z,{variant:"h4",gutterBottom:!0,children:"The Safe App is taking too long to load, consider refreshing."}),(0,s.jsx)(c.Z,{size:48,color:"primary"})]}),(0,s.jsx)("div",{style:{height:"100%",display:G?"none":"block",paddingBottom:P?Xe:0},children:(0,s.jsx)(mn.Z,{appUrl:n,allowedFeaturesList:t,iframeRef:W,onLoad:ae,title:null===L||void 0===L?void 0:L.name})}),(0,s.jsx)(en,{expanded:A,visible:P&&!E,setExpanded:k,onDismiss:_,transactions:I}),X&&(0,s.jsx)(fn,{isOpen:!0,origin:X.origin,requestId:X.requestId,onAccept:function(e,n){var t=ne(M.n.GRANTED);null===ie||void 0===ie||ie.send(t,n)},onReject:function(e){e?(ne(M.n.DENIED),null===ie||void 0===ie||ie.send("Permissions were rejected",e,!0)):ee(void 0)},permissions:X.request})]})]}):(0,s.jsx)("div",{})},Jn=function(){var e=(0,Q.ZP)(),n=(0,i.useRouter)(),t=(0,u.P)(),r=(0,je.Y)(t||"",e),d=r.safeApp,f=r.isLoading,p=(0,l.W)(),h=p.remoteSafeApps,m=p.remoteSafeAppsLoading,v=(0,T.hY)(),x=v.addPermissions,g=v.getPermissions,j=v.getAllowedFeaturesList,Z=(0,q.P$)(t),w=J({url:Z,safeApp:h.find((function(e){return e.url===t})),permissions:(null===d||void 0===d?void 0:d.safeAppsPermissions)||[],addPermissions:x,getPermissions:g,remoteSafeAppsLoading:m}),y=w.isModalVisible,b=w.isSafeAppInDefaultList,S=w.isFirstTimeAccessingApp,A=w.isConsentAccepted,E=w.isPermissionsReviewCompleted,k=w.onComplete,_=(0,a.useCallback)((function(){n.push({pathname:C.$.apps.index,query:{safe:n.query.safe}})}),[n]);return t&&n.isReady?y?(0,s.jsx)(W,{onCancel:_,onConfirm:k,features:d.safeAppsPermissions,appUrl:d.url,isConsentAccepted:A,isPermissionsReviewCompleted:E,isSafeAppInDefaultList:b,isFirstTimeAccessingApp:S},f?"loading":"loaded"):f?(0,s.jsx)(o.Z,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:(0,s.jsx)(c.Z,{})}):(0,s.jsx)(ee,{render:function(){return(0,s.jsx)(ce,{onBackToApps:function(){return n.back()}})},children:(0,s.jsx)(Yn,{appUrl:t,allowedFeaturesList:j(Z)})}):null}},58831:function(e){e.exports={barWrapper:"styles_barWrapper__m_ayi"}},77430:function(e){e.exports={wrapper:"styles_wrapper__gdZ9K",iframe:"styles_iframe__R6NQz",loadingContainer:"styles_loadingContainer__Gz7mR"}},97445:function(e){e.exports={wrapper:"styles_wrapper__fOVYe",content:"styles_content___EYfS",linkWrapper:"styles_linkWrapper__ifZ0K",icon:"styles_icon__LV5eh",image:"styles_image__0dp3c"}},31579:function(e){e.exports={sliderContainer:"styles_sliderContainer__4uMFw",sliderInner:"styles_sliderInner__cOVUt",sliderItem:"styles_sliderItem__Dvow5",disclaimerContainer:"styles_disclaimerContainer__IDDXT",disclaimerInner:"styles_disclaimerInner__OcCdI",domainIcon:"styles_domainIcon__qlW4z",domainText:"styles_domainText__8JmLr"}},89697:function(e){e.exports={container:"styles_container__0nVe2",arrow:"styles_arrow__KASF9"}}},function(e){e.O(0,[936,1249,8371,1677,7339,6211,9774,2888,179],(function(){return n=17173,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
//# sourceMappingURL=open-c329c3cdf6a2c2a8.js.map